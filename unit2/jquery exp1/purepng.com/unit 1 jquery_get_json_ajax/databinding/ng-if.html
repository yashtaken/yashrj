<!DOCTYPE html>
<html ng-app="directivesApp">
<head>
    <title>AngularJS Directives - ng-show, ng-hide, ng-if, ng-class</title>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; background: #f5f5f5; }
        .container { max-width: 800px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .section { margin: 20px 0; padding: 15px; border: 2px solid #ddd; border-radius: 5px; }
        .demo-box { padding: 15px; margin: 10px 0; border: 1px solid #ccc; border-radius: 4px; }
        
        .highlight { background-color: yellow; font-weight: bold; }
        .completed { text-decoration: line-through; color: #888; }
        .error { background-color: #ffebee; border-color: #f44336; color: #d32f2f; }
        .success { background-color: #e8f5e8; border-color: #4caf50; color: #2e7d32; }
        .warning { background-color: #fff3e0; border-color: #ff9800; color: #ef6c00; }
        .large-text { font-size: 18px; }
        .rotated { transform: rotate(5deg); display: inline-block; }

        .visible-true { background: #e8f5e8; }
        .visible-false { background: #ffebee; }

        .dom-info { background: #f8f9fa; padding: 10px; border-left: 4px solid #6c757d; margin: 10px 0; }
        .dom-highlight { background: #fff3cd; border: 2px dashed #ffc107; }
    </style>
</head>
<body ng-controller="DirectivesController">
    <div class="container">
        <h1>AngularJS Directives Deep Dive</h1>

        <!-- Section 1: ng-show vs ng-hide -->
        <div class="section">
            <h2>1. ng-show vs ng-hide</h2>
            <label>
                <input type="checkbox" ng-model="isVisible"> Toggle Visibility
            </label>

            <div class="demo-box" ng-show="isVisible" ng-class="isVisible ? 'visible-true' : 'visible-false'">
                <strong>ng-show="isVisible"</strong> - Element is shown when true.
            </div>

            <div class="demo-box" ng-hide="isVisible" ng-class="!isVisible ? 'visible-true' : 'visible-false'">
                <strong>ng-hide="isVisible"</strong> - Element is shown when false.
            </div>

            <div class="dom-info">
                <strong>DOM Inspection:</strong> Both remain in the DOM even when hidden (check Developer Tools).
            </div>
        </div>

        <!-- Section 2: ng-if -->
        <div class="section">
            <h2>2. ng-if - Conditional DOM Manipulation</h2>
            <label>
                <input type="checkbox" ng-model="useNgIf"> Toggle ng-if
            </label>

            <div class="demo-box dom-highlight" ng-if="useNgIf">
                <strong>ng-if="useNgIf"</strong> - Removed/recreated in DOM.
                <br>Time: {{ currentTime | date:'HH:mm:ss:sss' }}
            </div>

            <div class="dom-info">
                <strong>Note:</strong> Element is recreated each time itâ€™s shown. Scope is new each time.
            </div>
        </div>

        <!-- Section 3: Performance Comparison -->
        <div class="section">
            <h2>3. Performance Comparison</h2>
            <label>
                <input type="checkbox" ng-model="showHeavyContent" ng-change="updateHeavyResult()"> Show Heavy Content
            </label>

            <!-- Only show one version to avoid double computation -->
            <div class="demo-box" ng-if="showHeavyContent">
                <strong>ng-if</strong> - DOM and computation created only when needed.
                <br>Heavy computation: {{ heavyResult }}
            </div>

            <div class="dom-info">
                <strong>Tip:</strong> Use <code>ng-if</code> for expensive content/components.
            </div>
        </div>

        <!-- Section 4: ng-class -->
        <div class="section">
            <h2>4. ng-class - Dynamic CSS Classes</h2>

            <h3>4.1 Boolean Conditions</h3>
            <label><input type="checkbox" ng-model="isImportant"> Important</label>
            <label><input type="checkbox" ng-model="isDone"> Completed</label>

            <div class="demo-box" ng-class="{highlight: isImportant, completed: isDone}">
                Dynamic classes based on booleans.
                <br>Classes: {{ isImportant ? 'highlight ' : '' }}{{ isDone ? 'completed' : '' }}
            </div>

            <h3>4.2 Multiple Status Classes</h3>
            <select ng-model="status" ng-options="s for s in statusOptions track by s"></select>

            <div class="demo-box" ng-class="{
                'success': status === 'success',
                'error': status === 'error',
                'warning': status === 'warning'
            }">
                Status: {{ status }}
                <br>Class: {{ status }}
            </div>
        </div>

        <!-- Section 5: Advanced ng-class -->
        <div class="section">
            <h2>5. Advanced ng-class Usage</h2>

            <h3>5.1 Class from Controller Method</h3>
            <input type="number" ng-model="score" placeholder="Score (0-100)" min="0" max="100">

            <div class="demo-box" ng-class="getScoreClass(score)">
                Score: {{ score }}
                <br>Class: {{ getScoreClass(score) }}
            </div>

            <h3>5.2 Array Syntax</h3>
            <label><input type="checkbox" ng-model="useLargeText"> Large Text</label>
            <label><input type="checkbox" ng-model="useRotation"> Rotated</label>

            <div class="demo-box" ng-class="[useLargeText ? 'large-text' : '', useRotation ? 'rotated' : '']">
                This box uses array-based conditional classes.
            </div>
        </div>

        <!-- Debug Info -->
        <div class="section">
            <h2>Debug Info (Scope State)</h2>
            <pre>{{ {
                isVisible,
                useNgIf,
                showHeavyContent,
                isImportant,
                isDone,
                status,
                score,
                useLargeText,
                useRotation
            } | json }}</pre>
        </div>
    </div>

    <script>
        angular.module('directivesApp', [])
        .controller('DirectivesController', function($scope, $interval) {
            // Initial scope values
            $scope.isVisible = true;
            $scope.useNgIf = true;
            $scope.showHeavyContent = false;
            $scope.isImportant = false;
            $scope.isDone = false;
            $scope.statusOptions = ['success', 'error', 'warning'];
            $scope.status = 'success';
            $scope.score = 85;
            $scope.useLargeText = false;
            $scope.useRotation = false;
            $scope.heavyResult = null;

            // Update time
            $scope.currentTime = new Date();
            $interval(() => {
                $scope.currentTime = new Date();
            }, 100);

            // Simulate heavy computation (calculate only once per toggle)
            $scope.updateHeavyResult = function () {
                if ($scope.showHeavyContent) {
                    let result = 0;
                    for (let i = 0; i < 1_000_000; i++) {
                        result += Math.sqrt(i) * Math.random();
                    }
                    $scope.heavyResult = result.toFixed(2);
                } else {
                    $scope.heavyResult = null;
                }
            };

            // Method used in ng-class for score logic
            $scope.getScoreClass = function (score) {
                if (score >= 90) return 'success';
                if (score >= 70) return 'warning';
                return 'error';
            };
        });
    </script>
</body>
</html>